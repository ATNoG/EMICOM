[/==============================================================================
 / Brief   : Link SAP App Documentation
 / Authors : Carlos Guimaraes <cguimaraes@av.it.pt>
 /------------------------------------------------------------------------------
 / ODTONE - Open Dot Twenty One
 /
 / Copyright (C) 2010 Universidade Aveiro
 / Copyright (C) 2010 Instituto de Telecomunicações - Pólo Aveiro
 /
 / This software is distributed under a license. The full license
 / agreement can be found in the file LICENSE in this distribution.
 / This software may not be copied, modified, sold or distributed
 / other than expressed in the named license agreement.
 /
 / This software is distributed without any warranty.
 /=============================================================================]

[section:link_sap_index Link SAP]

The Link SAP specifies an abstract media dependent interface between the MIHF
and lower layers media-specific protocol stacks of technologies such as IEEE 802.3,
IEEE 802.11, IEEE 802.16, 3GPP and 3GPP2. For different link-layer technologies,
media-specific SAPs provide the functionality of Link SAP.

This implementation of Link SAP is very simple. It only support 2 kinds of events:
link down and link up events.

[section:link_sap_getStart Getting Started]

[section Detailed Description]

Link SAP has two different implementation: one for Linux and other one for
Windows. However, they do the exactly same thing. The Linux implementation use
['rtnetlink] and ['netlink] libraries to manage network interfaces, while windows
implementation use Windows SDK libraries.

As this is a simple Link SAP, it only supports link down and link up events.

[$./images/link_sap_state_machine.png]

When Link SAP begins to run, it will send a Link_Register.indication message
to the MIHF. Then, it stays in a state of waiting for messages from the
network interfaces. When an incoming message is receive, Link SAP sends it to the
event handler:
``
	void link_sap::link_sap::update(nic::interface* it);
``

In the event handler, is verified if the state of network interface has been
changed. If its state was changed, Link SAP will send a message to MIHF notifying
it about the succeeded. Otherwise, it won't do nothing and will discard the message
received.

[note Note that this implementation only process link up and link down events.]

After this cycle, Link SAP enters in the state of waiting for messages from the
network interfaces. When a new message is received the cycle begins.

[endsect]

[section Configuration]

	MIH Link SAP Configuration:
	   --help                           Display configuration options
	   --link.port arg (=1234)          Port
	   --link.tec arg                   Link SAP Technology
	   --link.link_addr_list arg        Link SAP Interface Address
	   --link.event_list arg            List of supported events
	   --link.command_list arg          List of supported commands
	   --conf.file arg (=link_sap.conf) Configuration File
	   --conf.recv_buff_len arg (=4096) Receive Buffer Length
	   --mihf.ip arg (=127.0.0.1)       Local MIHF Ip
	   --mihf.local_port arg (=1025)    MIHF Local Communications Port
	   --mihf.id arg (=local-mihf)      Local MIHF Id
	   --link.id arg (=link)            Link SAP Id

[note
*Link SAP Technology*

Network interface card technology.

Usage: tec = <NIC technology>

*Link SAP Interface Address*

Network interface card address.

Usage: link_addr_list = <interface address>

*Link SAP List of supported events*

Comma separated list of the Link SAP's supported events.

Usage: event_list = <link event 1>, <link event 2>, (...), <link event N>

*Link SAP List of supported events*

Comma separated list of the Link SAP's supported commands.

Usage: command_list = <link command 1>, <link command 2>, (...), <link command N>

]

Link SAP can be configured either through a configuration file or passing
directly, in command line, the configuration options.

[endsect]

[section Extending]

It is possible to do several extensions to Link SAP in a simple and fast way.

For example, in event handler can be added specific behaviour for other type of
event message received. So, Link SAP can notify MIHF about other changes in the
network interface.

``
	void link_sap::link_sap::update(nic::interface* it);
``


[endsect]

[section Running]

There is no running recommendation for Link SAP. It can be run after or before
the local MIHF.

So that the Link SAP detects some events, you should proceed to disconnect,
disable or shutdown your network cable/interface or your wireless card according
to your configuration file.

[endsect]

[endsect]

[endsect]
